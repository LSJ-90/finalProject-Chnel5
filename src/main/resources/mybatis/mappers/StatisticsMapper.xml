<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.hoge.mapper.StatisticsMapper">
  

	
  <!-- List<RegisterCountPerDayDto> getRegisterCountPerDayDto(); -->
  <select id="getRegisterCountPerDayDto" resultType="com.hoge.dto.RegisterCountPerDayDto">
		  SELECT SUBSTR(B.TODAY,-4) AS registerDate, NVL(SUM(a.NEW_USERS), 0) as count
		FROM (SELECT TO_CHAR(USER_REGISTERED_DATE, 'YYYYMMDD') AS REGISTER_DATE,
		COUNT(*) AS NEW_USERS
		FROM TB_FINAL_USERS
		WHERE USER_REGISTERED_DATE >= TO_CHAR (SYSDATE-7, 'YYYYMMDD')
		AND USER_REGISTERED_DATE &lt; TO_CHAR(SYSDATE, 'YYYYMMDD')
		GROUP BY TO_CHAR(USER_REGISTERED_DATE, 'YYYYMMDD')) A
		, (SELECT
		TO_CHAR (FIRST_DAY + LEVEL -1, 'YYYYMMDD') TODAY
		FROM (SELECT TRUNC(SYSDATE - 6) FIRST_DAY FROM DUAL)
		CONNECT BY FIRST_DAY + LEVEL - 1 &lt;= TRUNC(SYSDATE)
		) B
		WHERE B.TODAY = A.REGISTER_DATE(+)
		GROUP BY B.TODAY
		ORDER BY B.TODAY
  </select>
  
  

</mapper>